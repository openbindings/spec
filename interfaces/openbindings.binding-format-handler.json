{
    "openbindings": "0.1.0",
    "name": "OpenBindings Binding Format Handler",
    "version": "0.1.0",
    "description": "Unbound interface for OpenBindings binding format handler delegates. A binding format handler is a delegate that interprets a specific binding format (e.g., OpenAPI, AsyncAPI, Usage, MCP) and can create OpenBindings interfaces from binding source artifacts, execute operations via bindings, and list supported formats. This interface defines the contract without bindings — implementations import it and add their own bindings. Delegates SHOULD produce deterministic output for identical inputs. Error handling is binding-specific (e.g., CLI exit codes, HTTP status codes).",
    "imports": {
        "openbindings.software": "./openbindings.software.json"
    },
    "schemas": {
        "SoftwareInfo": {
            "type": "object",
            "description": "Identity and metadata for a piece of software. Canonical definition is in openbindings.software.json.",
            "properties": {
                "name": {
                    "type": "string",
                    "description": "Human-readable display name (e.g., 'Model Context Protocol')."
                },
                "version": {
                    "type": "string",
                    "description": "Software implementation version (e.g., '0.3.0'). Independent of the format spec version."
                },
                "description": {
                    "type": "string",
                    "description": "Brief description of what this software does."
                },
                "homepage": {
                    "type": "string",
                    "format": "uri",
                    "description": "URL to documentation or project page."
                },
                "repository": {
                    "type": "string",
                    "format": "uri",
                    "description": "URL to source code repository."
                },
                "maintainer": {
                    "type": "string",
                    "description": "Author or maintaining organization."
                }
            },
            "required": [
                "name"
            ],
            "additionalProperties": false
        },
        "Error": {
            "type": "object",
            "description": "Structured error information.",
            "properties": {
                "code": {
                    "type": "string",
                    "description": "Machine-readable error code."
                },
                "message": {
                    "type": "string",
                    "description": "Human-readable error message."
                },
                "details": {
                    "description": "Additional error details. Shape is error-specific."
                }
            },
            "required": [
                "code",
                "message"
            ],
            "additionalProperties": false
        },
        "CreateInterfaceSource": {
            "type": "object",
            "description": "A binding source to extract operations from. Provide content via 'location' or 'content'. Optionally control output representation via 'outputLocation' or 'embed'.",
            "properties": {
                "format": {
                    "type": "string",
                    "description": "Format token for this source (e.g., usage@2.13.1, openapi@3.1). Delegates MUST reject unsupported formats."
                },
                "name": {
                    "type": "string",
                    "description": "Key name for this binding source in the output OBI's sources. Optional; delegate chooses default if omitted."
                },
                "location": {
                    "type": "string",
                    "description": "Location to fetch content from (path or URL). Resolved relative to delegate execution context."
                },
                "content": {
                    "description": "Content provided directly. For JSON-based formats, typically a parsed JSON object. For non-JSON formats, typically a string containing the raw content."
                },
                "outputLocation": {
                    "type": "string",
                    "description": "In the output OBI, reference this location for the binding source. Ignored if 'embed' is true. If omitted, uses input 'location' when available; otherwise delegate-defined."
                },
                "embed": {
                    "type": "boolean",
                    "description": "If true, embed content inline in the output OBI's binding source. Default: false."
                },
                "description": {
                    "type": "string",
                    "description": "Human-readable description for this binding source in the output OBI."
                }
            },
            "required": [
                "format"
            ],
            "oneOf": [
                {
                    "required": [
                        "location"
                    ]
                },
                {
                    "required": [
                        "content"
                    ]
                }
            ],
            "additionalProperties": false
        },
        "CreateInterfaceInput": {
            "type": "object",
            "properties": {
                "openbindingsVersion": {
                    "type": "string",
                    "description": "Target OpenBindings spec version to emit (e.g., '0.1.0'). Optional; delegate default may apply."
                },
                "sources": {
                    "type": "array",
                    "items": {
                        "$ref": "#/schemas/CreateInterfaceSource"
                    },
                    "description": "Binding sources to extract from. Optional; when omitted, delegates MAY return a minimal or default interface."
                },
                "name": {
                    "type": "string",
                    "description": "Interface name. Overrides value derived from sources."
                },
                "version": {
                    "type": "string",
                    "description": "Interface contract version. Overrides value derived from sources."
                },
                "description": {
                    "type": "string",
                    "description": "Interface description. Overrides value derived from sources."
                }
            },
            "additionalProperties": false
        },
        "FormatInfo": {
            "type": "object",
            "description": "Information about a supported binding format.",
            "properties": {
                "token": {
                    "type": "string",
                    "description": "Format token (e.g., usage@2.13.1, openapi@3.1)."
                },
                "description": {
                    "type": "string",
                    "description": "Human-readable description of this format."
                }
            },
            "required": [
                "token"
            ],
            "additionalProperties": false
        },
        "OpenBindingsInterface": {
            "type": "object",
            "description": "A valid OpenBindings interface document in JSON format. Shape depends on the requested openbindingsVersion; see the OpenBindings spec for version-specific requirements.",
            "additionalProperties": true
        },
        "BasicCredentials": {
            "type": "object",
            "description": "Username/password credentials for HTTP Basic authentication.",
            "properties": {
                "username": {
                    "type": "string",
                    "description": "Username."
                },
                "password": {
                    "type": "string",
                    "description": "Password."
                }
            },
            "required": [
                "username",
                "password"
            ],
            "additionalProperties": false
        },
        "Credentials": {
            "type": "object",
            "description": "Well-known credential fields. All optional — the orchestrator supplies whichever credentials are relevant.",
            "properties": {
                "bearerToken": {
                    "type": "string",
                    "description": "Bearer token for HTTP Authorization header."
                },
                "apiKey": {
                    "type": "string",
                    "description": "API key. Where the key is placed (header, query, etc.) is binding-format-specific."
                },
                "basic": {
                    "$ref": "#/schemas/BasicCredentials",
                    "description": "HTTP Basic credentials."
                },
                "custom": {
                    "type": "object",
                    "description": "Credential fields not covered by the well-known fields above.",
                    "additionalProperties": true
                }
            },
            "additionalProperties": false
        },
        "BindingContext": {
            "type": "object",
            "description": "Runtime context for a binding execution. Produced by a binding context provider and passed to the format handler by the orchestrator. The delegate applies context fields where the protocol expects them (e.g., bearer token to Authorization header). All fields are optional.",
            "properties": {
                "credentials": {
                    "$ref": "#/schemas/Credentials",
                    "description": "Authentication credentials for the target."
                },
                "headers": {
                    "type": "object",
                    "description": "HTTP headers to include in the request.",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "cookies": {
                    "type": "object",
                    "description": "Cookies to include in the request.",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "environment": {
                    "type": "object",
                    "description": "Environment variables to set for the execution.",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "metadata": {
                    "type": "object",
                    "description": "Open map for context not covered by the well-known fields above.",
                    "additionalProperties": true
                }
            },
            "additionalProperties": false
        },
        "ExecuteSource": {
            "type": "object",
            "description": "Binding source for execution.",
            "properties": {
                "format": {
                    "type": "string",
                    "description": "Format token (e.g., openapi@3.1, usage@2.13.1)."
                },
                "location": {
                    "type": "string",
                    "description": "Location of the binding source (path or URL)."
                },
                "content": {
                    "description": "Binding source content directly. For JSON-based formats, typically a parsed object. For non-JSON formats, typically a string."
                }
            },
            "required": [
                "format"
            ],
            "oneOf": [
                {
                    "required": [
                        "location"
                    ]
                },
                {
                    "required": [
                        "content"
                    ]
                }
            ],
            "additionalProperties": false
        },
        "ExecuteOperationInput": {
            "type": "object",
            "description": "Input for executing an operation via a binding. Runtime context (credentials, headers, etc.) is provided via the optional 'context' field, typically produced by a binding context provider.",
            "properties": {
                "source": {
                    "$ref": "#/schemas/ExecuteSource",
                    "description": "The binding source containing the operation."
                },
                "ref": {
                    "type": "string",
                    "description": "Reference to the binding within the source. Format-specific (e.g., JSON Pointer for OpenAPI)."
                },
                "input": {
                    "description": "Operation input data. Shape is operation-specific."
                },
                "context": {
                    "$ref": "#/schemas/BindingContext",
                    "description": "Binding context provided by the orchestrator. The delegate applies context fields where the protocol expects them (e.g., bearer token to Authorization header). Optional; omitted when no context is available."
                }
            },
            "required": [
                "source",
                "ref"
            ],
            "additionalProperties": false
        },
        "ExecuteOperationOutput": {
            "type": "object",
            "description": "Output from executing an operation.",
            "properties": {
                "output": {
                    "description": "The operation's output data. Shape is operation-specific. Absent if error is present."
                },
                "status": {
                    "type": "integer",
                    "description": "Status or exit code. Interpretation is format-specific (HTTP status, CLI exit code, etc.)."
                },
                "durationMs": {
                    "type": "number",
                    "description": "Execution duration in milliseconds."
                },
                "error": {
                    "$ref": "#/schemas/Error",
                    "description": "Present if the operation failed."
                }
            },
            "additionalProperties": true
        }
    },
    "operations": {
        "getInfo": {
            "kind": "method",
            "description": "Return identity and metadata about this delegate.",
            "idempotent": true,
            "satisfies": [
                {
                    "interface": "openbindings.software",
                    "operation": "getInfo"
                }
            ],
            "output": {
                "$ref": "#/schemas/SoftwareInfo"
            }
        },
        "listFormats": {
            "kind": "method",
            "description": "List binding formats supported by this delegate.",
            "idempotent": true,
            "output": {
                "type": "array",
                "items": {
                    "$ref": "#/schemas/FormatInfo"
                }
            }
        },
        "createInterface": {
            "kind": "method",
            "description": "Create an OpenBindings interface, optionally from binding source artifacts.",
            "input": {
                "$ref": "#/schemas/CreateInterfaceInput"
            },
            "output": {
                "$ref": "#/schemas/OpenBindingsInterface"
            }
        },
        "executeOperation": {
            "kind": "method",
            "description": "Execute an operation via a binding. The delegate resolves the ref within the binding source, applies any provided context (credentials, headers, etc.) where the protocol expects them, executes via the binding-native protocol, and returns the result.",
            "input": {
                "$ref": "#/schemas/ExecuteOperationInput"
            },
            "output": {
                "$ref": "#/schemas/ExecuteOperationOutput"
            }
        }
    }
}
